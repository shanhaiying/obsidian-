---
title: 第4章：行走生成函数
date: 2024-11-16
tags: [图论, 行走生成函数]
---

# 第4章：行走生成函数

### Walk Generating Function (Definition)

- **定义**: $W(G, x)$ 是图 $G$ 中从顶点 $i$ 到顶点 $j$ 所有路径的生成函数。
- **公式**:
  $$
  W(G, x) = \sum_{r \geq 0} A^r x^r = (I - xA)^{-1}
  $$
- **解释**: 通过该生成函数可以对路径进行计数。


## 4.1 雅可比定理

### 行走生成函数
行走生成函数 $W_{ij}(G,x)$ 用于计算图 $G$ 中从顶点 $i$ 出发并在顶点 $j$ 结束的行走数量。

### 雅可比定理等式
- 在本章第1节，利用雅可比的行列式恒等式可证明：
$$x^{-1}W_{ij}(G,x^{-1})=\frac{\varphi(G\setminus i,x)\varphi(G\setminus j,x)-\varphi(G,x)\cdot\varphi(G\setminus ij,x)^{1/2}}{\varphi(G,x)}$$
- 在第2节，可证明：
$$x^{-1}W_{ij}(G,x^{-1})=\sum\frac{\varphi(G\setminus P,x)}{\varphi(G,x)}$$
其中求和是对图 $G$ 中以 $i$ 和 $j$ 为端点的所有路径进行的。在这两个等式中，左边是变量 $x^{-1}$ 的实系数形式幂级数，右边是 $x^{-1}$ 的有理函数（尽管看起来不太像）。

### 应用
给出这两个等式的一些应用如下：
- 在第4节，从正交多项式理论推导出克里斯托费尔 - 达布恒等式的扩展形式。这些将在第8章用于重新推导克里斯托费尔 - 达布恒等式本身。
- 在第5节，给出图特证明的一个简化版本，即特征多项式在有理数域上不可约的图是顶点可重构的。该证明关键依赖于上述第一个等式右边出现的平方根。

### 雅可比定理细节
此定理能让我们用图 $G$ 的子图的特征多项式来表示行走生成函数 $W_{ij}(G,x)$。所需工具是 [[方阵和的行列式|矩阵行列式求和公式]]（在引理2.1.2中给出）以及矩阵逆的著名表达式.  #
#### 引理1.1
**1.1引理**：对于任何图 $G$，有
$$W(G,x)=x^{-1}\varphi(G,x^{-1})^{-1}\text{adj}(x^{-1}I - A)$$
**证明**：令 $y = x^{-1}$，则
$$(I - xA)^{-1}=y(yI - A)^{-1}=y\varphi(G,y)^{-1}\text{adj}(yI - A)$$
由此可得结果。
由引理1.1可立即推出
$$W_{ii}(G,x)=x^{-1}\varphi(G\setminus i,x^{-1}) / \varphi(G,x^{-1})$$

#### 定理1.2
**1.2定理（雅可比）**：设 $D$ 是图 $G$ 的 $d$ 个顶点的子集。则
$$\det W_{D,D}(G,x)=x^{-d}\varphi(G\setminus D,x^{-1}) / \varphi(G,x^{-1})$$

## 4.2 行走和路径

### $W_{ij}(G,x)$ 的另一种表达式
设 $N_{ij}(G,x)$ 是图 $G$ 中从顶点 $i$ 出发、在顶点 $j$ 结束且只访问顶点 $i$ 一次的行走的生成函数。设 $P_{ij}=P_{ij}(G)$ 表示图 $G$ 中从顶点 $i$ 到顶点 $j$ 的路径集合。若 $P$ 是图 $G$ 中的一条路径，那么 $G\setminus P$ 是从 $G$ 中删除 $P$ 的每个顶点后得到的图。

### 引理2.1
**引理2.1**：设 $i$ 和 $j$ 是图 $G$ 中的顶点。则
$$\varphi_{ij}(G,x)=\sum_{P\in P_{ij}}\varphi(G\setminus P,x)$$

### 行走分解
图 $G$ 中从 $i$ 到 $j$ 的每一次行走都唯一地分解为从 $i$ 开始的闭行走，接着是从 $i$ 到 $j$ 的“不返回”行走。这意味着
$$x^{-1}W_{ij}(G,x^{-1})=x^{-1}W_{ii}(G,x^{-1})-N_{ij}(G,x^{-1})$$

### 不返回行走分解
长度为 $m$ 的从 $i$ 到 $j$ 的不返回行走唯一地分解为从 $i$ 到 $i$ 的一个邻点的长度为1的行走，接着是在 $G\setminus i$ 中从这个邻点到 $j$ 的长度为 $m - 1$ 的行走。因此，
$$N_{ij}(G,x^{-1})=\sum x^{-1}W_{kj}(G\setminus i,x^{-1})$$
